filename = paste0("plots/0a_Resp_Barplot_female.png")
#add significance values
annotation_df <- data.frame(
SpID= c("f1","f1","f1", "f2", "f2","f2"),
start = c("f1_ang/f2_fea", "Baseline", "Baseline","f1_ang/f2_fea", "Baseline", "Baseline"),
end = c("f1_fea/f2_ang", "f1_ang/f2_fea", "f1_fea/f2_ang", "f1_fea/f2_ang", "f1_ang/f2_fea", "f1_fea/f2_ang"),
y = c(0.55, 0.6, 0.65, 0.55, 0.6, 0.65),
label = c("n.s.", "n.s.","n.s.","**","*","n.s.")
)
p2<-ggplot(data= E2_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 3, vjust = -0.2, manual = TRUE) +
facet_wrap(~ SpID, ncol = 2) +
scale_fill_manual(values=c("grey", "darkred", "chocolate4"),
labels=c("Baseline" = "Baseline",
"f1_ang/f2_fea" = "AdaptCond1: f1_ang | f2_fea",
"f1_fea/f2_ang" = "AdaptCond2: f1_fea | f2_ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#-------------------------------------------------------------------------------#
#                      2b - Barplots, male                                     #
#-------------------------------------------------------------------------------#
E2_plot_agg2<- mySummary(E2_plot_m, Resp, Participant, SpID, AdaptType)
E2_plot_agg2<- mySummary(E2_plot_agg2, Resp, SpID, AdaptType)
yTitleStr = "Proportion of angry responses"
filename = paste0("plots/0a_Resp_Barplot_male.png")
#add significance values
annotation_df <- data.frame(
SpID= c("m3","m3","m3", "m4", "m4","m4"),
start = c("m3_ang/m4_fea", "Baseline", "Baseline","m3_ang/m4_fea", "Baseline", "Baseline"),
end = c("m3_fea/m4_ang", "m3_ang/m4_fea", "m3_fea/m4_ang", "m3_fea/m4_ang", "m3_ang/m4_fea", "m3_fea/m4_ang"),
y = c(0.36, 0.4, 0.44, 0.62, 0.66, 0.7),
label = c("***", "n.s.","**","***","n.s.","n.s.")
)
p2b<-ggplot(data= E2_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 3, vjust = -0.2, manual = TRUE) +
facet_wrap(~ SpID, ncol = 2) +
scale_fill_manual(values=c("grey", "purple", "darkblue"),
labels=c("Baseline" = "Baseline",
"m3_ang/m4_fea" = "AdaptCond1: m3_ang | m4_fea",
"m3_fea/m4_ang" = "AdaptCond2: m3_fea | m4_ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2b
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#----------------------------------------------#
#                Combining plots               #
#----------------------------------------------#
#-----------------------------------
# Now we arrange these plots
filename = paste0("plots/03_plots_combined.png")
p <- plot_grid(p1, p1b, p2, p2b, nrow = 2, rel_widths = c(1,1), labels = c("A", "B", "C", "D"))
ggsave(filename, width = 17, height = 17, dpi =300)
##End of Script
##########################################################################
## File: 03_Exp2_data_visualization.R
## Data Analysis for Exp 2: Adaptation of Emotion - speaker identities
# author: Christine Nussbaum und Dorothea Berges
# date 02/2022, revised 11/2025
# clear directory
rm(list=ls())
#set working directory to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# load required packages
library("tidyverse")
library(ggsignif)
library(gridExtra) # version 2.3
library(ggpubr)    # version 0.6.0
library(cowplot)   # version 1.1.1
# load relevant functions
source("functions/mySummary.R")
#---------------------------------------------------------------------------------
#get the raw input data
load(file ="input/Exp2_without_omissions.RData")
#-------------------------------------------------------------------------------#
#        1 - Plot response data, for each tML - females only                    #
#-------------------------------------------------------------------------------#
#average raw data (for both Adapt and Baseline Blocks)
E2_Adapt_plot <- mySummary(E2_Adapt[E2_Adapt$SpSex == "f",], Resp, Participant, tML, SpID, AdaptType)
E2_Bline_plot <- mySummary(E2_Bline[E2_Bline$SpSex == "f",], Resp, Participant, tML, SpID, Block)
E2_Bline_plot <- E2_Bline_plot %>% rename(AdaptType= Block)
E2_plot <- rbind(E2_Adapt_plot, E2_Bline_plot)
rm(E2_Adapt_plot, E2_Bline_plot)
E2_plot_agg<- mySummary(E2_plot, Resp, tML,  SpID, AdaptType)
#[1a] Response per tML, SpID and AdaptType , females only
yTitleStr = "Proportion of angry responses"
xTitleStr = "Target Morphlevel (tML)"
facetStr =  " splitted per SpSex and AdaptType"
title = paste0("Mean ", yTitleStr, " per ", xTitleStr, facetStr)
filename = paste0("plots/01a_Resp_Exp2_female.png")
#Plot
p1<-(ggplot(data= E2_plot_agg, aes(x = tML, y=Resp, color = AdaptType, group=AdaptType)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(x = xTitleStr , y = yTitleStr) + #, title = title
facet_wrap(~ SpID, ncol = 2) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
scale_colour_manual(values=c("grey", "darkred", "chocolate4")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(color = "black", size = 14), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
strip.text.x = element_text(size = 14),
legend.position = "none") +
scale_y_continuous(limits=c(0,1.0), breaks = c( 0.0, 0.2, 0.4, 0.6, 0.8, 1.0)))
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
E2_plot_f <- E2_plot
E2_plot_agg_f <- E2_plot_agg
#-------------------------------------------------------------------------------#
#        1b - Plot response data, for each tML - males only                    #
#-------------------------------------------------------------------------------#
#average raw data (for both Adapt and Baseline Blocks)
E2_Adapt_plot <- mySummary(E2_Adapt[E2_Adapt$SpSex == "m",], Resp, Participant, tML, SpID, AdaptType)
E2_Bline_plot <- mySummary(E2_Bline[E2_Bline$SpSex == "m",], Resp, Participant, tML, SpID, Block)
E2_Bline_plot <- E2_Bline_plot %>% rename(AdaptType= Block)
E2_plot <- rbind(E2_Adapt_plot, E2_Bline_plot)
rm(E2_Adapt_plot, E2_Bline_plot)
E2_plot_agg<- mySummary(E2_plot, Resp, tML,  SpID, AdaptType)
#[1a] Response per tML, SpID and AdaptType , males only
yTitleStr = "Proportion of angry responses"
xTitleStr = "Target Morphlevel (tML)"
facetStr =  " splitted per SpSex and AdaptType"
title = paste0("Mean ", yTitleStr, " per ", xTitleStr, facetStr)
filename = paste0("plots/01b_Resp_Exp2_male.png")
#Plot
p1b<-(ggplot(data= E2_plot_agg, aes(x = tML, y=Resp, color = AdaptType, group=AdaptType)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(x = xTitleStr , y = yTitleStr) + #, title = title
facet_wrap(~ SpID, ncol = 2) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
scale_colour_manual(values=c("grey", "purple", "darkblue")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(color = "black", size = 14), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
strip.text.x = element_text(size = 14),
legend.position = "none") +
scale_y_continuous(limits=c(0,1.0), breaks = c( 0.0, 0.2, 0.4, 0.6, 0.8, 1.0)))
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
E2_plot_m <- E2_plot
E2_plot_agg_m <- E2_plot_agg
#-------------------------------------------------------------------------------#
#                      2a - Barplots, female                                     #
#-------------------------------------------------------------------------------#
E2_plot_agg2<- mySummary(E2_plot_f, Resp, Participant, SpID, AdaptType)
E2_plot_agg2<- mySummary(E2_plot_agg2, Resp, SpID, AdaptType)
yTitleStr = "Proportion of angry responses"
filename = paste0("plots/0a_Resp_Barplot_female.png")
#add significance values
annotation_df <- data.frame(
SpID= c("f1","f1","f1", "f2", "f2","f2"),
start = c("f1_ang/f2_fea", "Baseline", "Baseline","f1_ang/f2_fea", "Baseline", "Baseline"),
end = c("f1_fea/f2_ang", "f1_ang/f2_fea", "f1_fea/f2_ang", "f1_fea/f2_ang", "f1_ang/f2_fea", "f1_fea/f2_ang"),
y = c(0.55, 0.6, 0.65, 0.55, 0.6, 0.65),
label = c("n.s.", "n.s.","n.s.","**","*","n.s.")
)
p2<-ggplot(data= E2_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 6, vjust = -0.2, manual = TRUE) +
facet_wrap(~ SpID, ncol = 2) +
scale_fill_manual(values=c("grey", "darkred", "chocolate4"),
labels=c("Baseline" = "Baseline",
"f1_ang/f2_fea" = "AdaptCond1: f1_ang | f2_fea",
"f1_fea/f2_ang" = "AdaptCond2: f1_fea | f2_ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#-------------------------------------------------------------------------------#
#                      2b - Barplots, male                                     #
#-------------------------------------------------------------------------------#
E2_plot_agg2<- mySummary(E2_plot_m, Resp, Participant, SpID, AdaptType)
E2_plot_agg2<- mySummary(E2_plot_agg2, Resp, SpID, AdaptType)
yTitleStr = "Proportion of angry responses"
filename = paste0("plots/0a_Resp_Barplot_male.png")
#add significance values
annotation_df <- data.frame(
SpID= c("m3","m3","m3", "m4", "m4","m4"),
start = c("m3_ang/m4_fea", "Baseline", "Baseline","m3_ang/m4_fea", "Baseline", "Baseline"),
end = c("m3_fea/m4_ang", "m3_ang/m4_fea", "m3_fea/m4_ang", "m3_fea/m4_ang", "m3_ang/m4_fea", "m3_fea/m4_ang"),
y = c(0.36, 0.4, 0.44, 0.62, 0.66, 0.7),
label = c("***", "n.s.","**","***","n.s.","n.s.")
)
p2b<-ggplot(data= E2_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 6, vjust = -0.2, manual = TRUE) +
facet_wrap(~ SpID, ncol = 2) +
scale_fill_manual(values=c("grey", "purple", "darkblue"),
labels=c("Baseline" = "Baseline",
"m3_ang/m4_fea" = "AdaptCond1: m3_ang | m4_fea",
"m3_fea/m4_ang" = "AdaptCond2: m3_fea | m4_ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2b
#abspeichern
ggsave(filename, width = 10, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#----------------------------------------------#
#                Combining plots               #
#----------------------------------------------#
#-----------------------------------
# Now we arrange these plots
filename = paste0("plots/03_plots_combined.png")
p <- plot_grid(p1, p1b, p2, p2b, nrow = 2, rel_widths = c(1,1), labels = c("A", "B", "C", "D"))
ggsave(filename, width = 17, height = 17, dpi =300)
##End of Script
# clear directory
rm(list=ls())
#set working directory to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# load required packages
library("tidyverse")
# load relevant functions
source("functions/loadPTKExperimentData.R")
source("functions/mySummary.R")
#---------------------------------------------------------------------------------
#get the raw data:
D <- loadPTKExperimentData(relDirPath = "input/raw/")
#number of participants
print(paste("There are currently", length(unique(D$Subject)), "participants loaded."))
#reorder columns - Subject Variablen zuerst
D <- D[,c(17,16,15, 1:14)]
E2_Bline <- D[,-c(12:17)] %>% filter(V1 == "Baseline")
E2_Adapt <- D %>% filter(V1 == "Antwort")
#[2] Rename Variables
names(E2_Bline) <- c("Participant", "Date", "Experiment","Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp","RT" )
names(E2_Adapt) <- c("Participant", "Date", "Experiment", "Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp", "RT", "AdaptType", "Blockorder", "TopUp", "z", "TopupM", "TopupF")
#[3] Adjust some settings of variables
E2_Bline$Resp <- as.numeric(E2_Bline$Resp)
E2_Adapt$Resp <- as.numeric(E2_Adapt$Resp)
#sort out all the counting variables responsible for the top-up E2_Adaptation:
E2_Adapt$z <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$z)
E2_Adapt$TopupM <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupM)
E2_Adapt$TopupF <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupF)
E2_Adapt$TopUp <- ifelse(E2_Adapt$TopUp == 0, "Yes", NA) #Code if this was a TopUp Trial
#recode the Response for both datasets
E2_Bline$Resp <- E2_Bline$Resp -1 # umkodieren
E2_Adapt$Resp <- E2_Adapt$Resp -1 # umkodieren
E2_Adapt$AdaptType <- recode(E2_Adapt$AdaptType,
"Identität1_angry/Identität3_fearful" = "f1_ang/f2_fea",
"Identität3_angry/Identität1_fearful" = "f1_fea/f2_ang",
"Identität3_angry/Identität4_fearful" = "m3_ang/m4_fea",
"Identität4_angry/Identität3_fearful" = "m3_fea/m4_ang")
E2_Adapt$SpID <- recode(E2_Adapt$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
E2_Bline$SpID <- recode(E2_Bline$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
#[1] N different stimuli per participant
table(E2_Bline$Participant) #should be 112 per participant
table(E2_Adapt$Participant) #should be 224 per participant
#code a stimulus variable
E2_Bline$Stimulus <- str_c(E2_Bline$SpID, E2_Bline$Word, E2_Bline$tML, sep = "_")
table(table(E2_Bline$Stimulus, E2_Bline$Participant)) #should give out only "1"s
#[3]Is every stimulus picked exactly twice? - Adaptation
E2_Adapt$Stimulus <- str_c(E2_Adapt$SpID, E2_Adapt$Word, E2_Adapt$tML, sep = "_")
table(table(E2_Adapt$Stimulus, E2_Adapt$Participant)) #should give out only "2"s
Check_Bline <- E2_Bline %>% group_by(Participant) %>% summarise(var = var(Resp)) # d1685a2f
Check_Bline <- E2_Bline %>% group_by(Participant) %>% summarise(var = var(Resp)) # d1685a2f
Check_Adapt <- E2_Adapt %>% group_by(Participant) %>% summarise(var = var(Resp)) # d1685a2f
# clear directory
rm(list=ls())
#set working directory to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# load required packages
library("tidyverse")
# load relevant functions
source("functions/loadPTKExperimentData.R")
source("functions/mySummary.R")
#---------------------------------------------------------------------------------
#get the raw data:
D <- loadPTKExperimentData(relDirPath = "input/raw/")
#number of participants
print(paste("There are currently", length(unique(D$Subject)), "participants loaded."))
#reorder columns - Subject Variablen zuerst
D <- D[,c(17,16,15, 1:14)]
E2_Bline <- D[,-c(12:17)] %>% filter(V1 == "Baseline")
E2_Adapt <- D %>% filter(V1 == "Antwort")
#[2] Rename Variables
names(E2_Bline) <- c("Participant", "Date", "Experiment","Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp","RT" )
names(E2_Adapt) <- c("Participant", "Date", "Experiment", "Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp", "RT", "AdaptType", "Blockorder", "TopUp", "z", "TopupM", "TopupF")
#[3] Adjust some settings of variables
E2_Bline$Resp <- as.numeric(E2_Bline$Resp)
E2_Adapt$Resp <- as.numeric(E2_Adapt$Resp)
#sort out all the counting variables responsible for the top-up E2_Adaptation:
E2_Adapt$z <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$z)
E2_Adapt$TopupM <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupM)
E2_Adapt$TopupF <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupF)
E2_Adapt$TopUp <- ifelse(E2_Adapt$TopUp == 0, "Yes", NA) #Code if this was a TopUp Trial
#recode the Response for both datasets
E2_Bline$Resp <- E2_Bline$Resp -1 # umkodieren
E2_Adapt$Resp <- E2_Adapt$Resp -1 # umkodieren
E2_Adapt$AdaptType <- recode(E2_Adapt$AdaptType,
"Identität1_angry/Identität3_fearful" = "f1_ang/f2_fea",
"Identität3_angry/Identität1_fearful" = "f1_fea/f2_ang",
"Identität3_angry/Identität4_fearful" = "m3_ang/m4_fea",
"Identität4_angry/Identität3_fearful" = "m3_fea/m4_ang")
E2_Adapt$SpID <- recode(E2_Adapt$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
E2_Bline$SpID <- recode(E2_Bline$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
#[1] N different stimuli per participant
table(E2_Bline$Participant) #should be 112 per participant
table(E2_Adapt$Participant) #should be 224 per participant
#code a stimulus variable
E2_Bline$Stimulus <- str_c(E2_Bline$SpID, E2_Bline$Word, E2_Bline$tML, sep = "_")
table(table(E2_Bline$Stimulus, E2_Bline$Participant)) #should give out only "1"s
#[3]Is every stimulus picked exactly twice? - Adaptation
E2_Adapt$Stimulus <- str_c(E2_Adapt$SpID, E2_Adapt$Word, E2_Adapt$tML, sep = "_")
table(table(E2_Adapt$Stimulus, E2_Adapt$Participant)) #should give out only "2"s
Check_Bline <- E2_Bline %>% group_by(Participant) %>% summarise(var = var(Resp)) # d1685a2f
Check_Adapt <- E2_Adapt %>% group_by(Participant) %>% summarise(var = var(Resp)) # d1685a2f
#"dd1685a2f" pressed only one key, so will be removed
E2_Adapt <- E2_Adapt %>% filter(Participant != "d1685a2f")
E2_Bline <- E2_Bline %>% filter(Participant != "d1685a2f")
#"114de282" had 40 missings in the baseline and will be removed
E2_Adapt <- E2_Adapt %>% filter(Participant != "114de282")
E2_Bline <- E2_Bline %>% filter(Participant != "114de282")
#"c742580d" had problems with the sound playback and will be removed
E2_Adapt <- E2_Adapt %>% filter(Participant != "c742580d")
E2_Bline <- E2_Bline %>% filter(Participant != "c742580d")
rm(Check_Bline, Check_Adapt)
#---------------------------------------------------------------------------------
#Save datasets
save(E2_Bline, E2_Adapt, file ="input/Exp2_raw_data.RData")
rm(D)
#load raw survey data
S2 <- read.csv(file ="input/data_Exp2.csv")
#rename participant
S2$participant <- substr(S2$participant, 31,38)
#keep only the ones with an experimental file
S2 <- S2 %>% filter(participant %in% unique(E2_Adapt$Participant)) # check: N = 42
#load raw survey data
S2 <- read.csv(file ="input/data_Exp2.csv")
#rename participant
S2$participant <- substr(S2$participant, 31,38)
#keep only the ones with an experimental file
S2 <- S2 %>% filter(participant %in% unique(E2_Adapt$Participant)) # check: N = 42
S2$VPN_Code <- paste0(S2$LPartCode_1, S2$LPartCode_2, S2$LPartCode_3, S2$LPartCode_4, S2$LPartCode_5, S2$LPartCode_6)
#rename a few variables
S2 <- S2 %>% select(!c(intro_question1_1,
TIME_start,
TIME_end,
CLIENT_start,
LPartCode_1,
LPartCode_2,
LPartCode_3,
LPartCode_4,
LPartCode_5,
LPartCode_6,
StartRatingExperiment_1)) %>%
rename(LAge = LAge_1,
LSex = LSex_1,
LMotherLanguage = LMotherLanguage_1,
LStudyWork = LStudyWork_1,
LHearingKown = LHearingDisabilitiesKnown_1,
LHearingKind = LHearingDisabilitiesKind_1,
LHearingImp = LHearingDisabilitiesConstraint_1,
Anmerkungen = Anmerkungen_1,
InstructionsClear = afterExp2InstructionsClear_1,
Strategy = afterExp4Strategy_1,
Eval1 = afterExp3RatingEvaluation_1,
Eval2 = afterExp3RatingEvaluation_2,
Eval3 = afterExp3RatingEvaluation_3,
Eval4 = afterExp3RatingEvaluation_4,
Eval5 = afterExp3RatingEvaluation_5,
Eval6 = afterExp3RatingEvaluation_6,
Eval7 = afterExp3RatingEvaluation_7,
Eval8 = afterExp3RatingEvaluation_8)
#save survey
save(S2, file="input/Exp2_survey.RData")
# clear directory
rm(list=ls())
#set working directory to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# load required packages
library("tidyverse")
# load relevant functions
source("functions/loadPTKExperimentData.R")
source("functions/mySummary.R")
#---------------------------------------------------------------------------------
#get the raw data:
D <- loadPTKExperimentData(relDirPath = "input/raw/")
#number of participants
print(paste("There are currently", length(unique(D$Subject)), "participants loaded."))
#reorder columns - Subject Variablen zuerst
D <- D[,c(17,16,15, 1:14)]
E2_Bline <- D[,-c(12:17)] %>% filter(V1 == "Baseline")
E2_Adapt <- D %>% filter(V1 == "Antwort")
#[2] Rename Variables
names(E2_Bline) <- c("Participant", "Date", "Experiment","Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp","RT" )
names(E2_Adapt) <- c("Participant", "Date", "Experiment", "Block", "Duration", "SpID", "Word", "tML", "SpSex", "Resp", "RT", "AdaptType", "Blockorder", "TopUp", "z", "TopupM", "TopupF")
#[3] Adjust some settings of variables
E2_Bline$Resp <- as.numeric(E2_Bline$Resp)
E2_Adapt$Resp <- as.numeric(E2_Adapt$Resp)
#sort out all the counting variables responsible for the top-up E2_Adaptation:
E2_Adapt$z <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$z)
E2_Adapt$TopupM <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupM)
E2_Adapt$TopupF <- ifelse(E2_Adapt$TopUp != 0, NA, E2_Adapt$TopupF)
E2_Adapt$TopUp <- ifelse(E2_Adapt$TopUp == 0, "Yes", NA) #Code if this was a TopUp Trial
#recode the Response for both datasets
E2_Bline$Resp <- E2_Bline$Resp -1 # umkodieren
E2_Adapt$Resp <- E2_Adapt$Resp -1 # umkodieren
E2_Adapt$AdaptType <- recode(E2_Adapt$AdaptType,
"Identität1_angry/Identität3_fearful" = "f1_ang/f2_fea",
"Identität3_angry/Identität1_fearful" = "f1_fea/f2_ang",
"Identität3_angry/Identität4_fearful" = "m3_ang/m4_fea",
"Identität4_angry/Identität3_fearful" = "m3_fea/m4_ang")
E2_Adapt$SpID <- recode(E2_Adapt$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
E2_Bline$SpID <- recode(E2_Bline$SpID ,
"nf01" = "f1",
"nf03" = "f2",
"nm03" = "m3",
"nm04" = "m4")
#[1] N different stimuli per participant
table(E2_Bline$Participant) #should be 112 per participant
table(E2_Adapt$Participant) #should be 224 per participant
