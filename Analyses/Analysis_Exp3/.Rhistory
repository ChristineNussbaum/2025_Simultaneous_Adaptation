AdaptType_w04b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_w04,d_AdaptType_w04,
AdaptType_w04b, d_AdaptType_w04b,
AdaptType_w04b2, d_AdaptType_w04b2,
file = "output/Exp3_Resp_post-hoc_w04.txt")
#keep environment tidy
rm(AdaptType_w04,d_AdaptType_w04, AdaptType_w04b, d_AdaptType_w04b, AdaptType_w04b2, d_AdaptType_w04b2)
AdaptType_w04 <- t.test(w04$`pw12_ang/pw34_fea`, w04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_w0 <- t_to_d(AdaptType_w04$statistic, AdaptType_w04$parameter, paired = TRUE)
AdaptType_w04b <- t.test(w04$Baseline, w04$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_w04b <- t_to_d(AdaptType_w04b$statistic, AdaptType_w04b$parameter, paired = TRUE)
AdaptType_w04b2 <- t.test(w04$Baseline, w04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_w04b2 <- t_to_d(AdaptType_w04b2$statistic, AdaptType_w04b2$parameter, paired = TRUE)
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_w04,d_AdaptType_w04,
AdaptType_w04b, d_AdaptType_w04b,
AdaptType_w04b2, d_AdaptType_w04b2,
file = "output/Exp3_Resp_post-hoc_w04.txt")
#keep environment tidy
rm(AdaptType_w04,d_AdaptType_w04, AdaptType_w04b, d_AdaptType_w04b, AdaptType_w04b2, d_AdaptType_w04b2)
AdaptType_w04 <- t.test(w04$`pw12_ang/pw34_fea`, w04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_w04 <- t_to_d(AdaptType_w04$statistic, AdaptType_w04$parameter, paired = TRUE)
AdaptType_w04b <- t.test(w04$Baseline, w04$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_w04b <- t_to_d(AdaptType_w04b$statistic, AdaptType_w04b$parameter, paired = TRUE)
AdaptType_w04b2 <- t.test(w04$Baseline, w04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_w04b2 <- t_to_d(AdaptType_w04b2$statistic, AdaptType_w04b2$parameter, paired = TRUE)
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_w04,d_AdaptType_w04,
AdaptType_w04b, d_AdaptType_w04b,
AdaptType_w04b2, d_AdaptType_w04b2,
file = "output/Exp3_Resp_post-hoc_w04.txt")
#keep environment tidy
rm(AdaptType_w04,d_AdaptType_w04, AdaptType_w04b, d_AdaptType_w04b, AdaptType_w04b2, d_AdaptType_w04b2)
View(w01)
#prepare for JASP
JASP <- rbind(w01, w02, w03, w04)
View(JASP)
names(JASP)
JASP <- pivot_wider(JASP[,1:5], names_from = c(Word), values_from = c(pw12_ang/pw34_fea:Baseline)
JASP <- pivot_wider(JASP[,1:5], names_from = c(Word), values_from = c(pw12_ang/pw34_fea:Baseline))
JASP <- pivot_wider(JASP[,1:5], names_from = c(Word), values_from = c(pw12_ang/pw34_fea:Baseline))
JASP <- pivot_wider(JASP[,1:5], names_from = c(Word), values_from = c(`pw12_ang/pw34_fea`:Baseline))
View(JASP)
write.csv(JASP, file = "JASP/pw_analysis.csv")
E3_RespF <- E3_Resp %>% filter(SpSex =="f")
E3_Resp <- mySummary(E3_Adapt, Resp, Participant, Word, AdaptType, SpSex) #does not contain Baseline
E3_RespF <- E3_Resp %>% filter(SpSex =="f")
View(E3_RespF)
a<-ezANOVA(data=E3_RespF, dv=.(Resp), wid=.(Participant), within = .(AdaptType, Word), type=3, detailed = TRUE)
b = tracedEzOut(a, print = TRUE, sph.cor = "HF", mau.p = 0.05, etasq = "partial", dfsep = ", ")
capture.output(b, file= "output/Exp3_Resp_ANOVAIIb_females.txt")
# visualize data (just to check)
ezPlot(data=E3_RespF, dv=.(Resp), wid=.(Participant), within = .(AdaptType, Word), split=Word, x=AdaptType)
#aggregate Data (in this case not really necessary)
PH1 <- E3_RespF %>% group_by(Participant, Word, AdaptType) %>% summarise(Resp = mean(Resp))
#get descriptive data
PH1_descriptive <- mySummary(PH1, Resp, Word, AdaptType)
View(PH1_descriptive)
#convert partly into wide format
PH1 <- spread(PH1, AdaptType, Resp)
###separate per speaker sex
Fw01<- PH1 %>% filter(Word == "w01")
Fw02<- PH1 %>% filter(Word == "w02")
Fw03<- PH1 %>% filter(Word == "w03")
Fw04<- PH1 %>% filter(Word == "w04")
###now we add the Baseline information
E3_Bline_Resp <- mySummary(E3_Bline, Resp, Participant, Word, SpSex)
E3_Bline_Resp <- E3_Bline_Resp %>% filter(SpSex == "f")
View(E3_Bline_Resp)
E3_Bline_Resp <- E3_Bline_Resp %>% rename(Baseline = Resp)
Baseline_descriptive <- mySummary(E3_Bline_Resp, Baseline, Word)
BlineFw01<- E3_Bline_Resp[,1:3] %>% filter(Word == "w01")
Fw01 <- merge(Fw01, BlineFw01)
BlineFw02<- E3_Bline_Resp[,1:3] %>% filter(Word == "w02")
Fw02 <- merge(Fw02, BlineFw02)
BlineFw03<- E3_Bline_Resp[,1:3] %>% filter(Word == "w03")
Fw03 <- merge(Fw03, BlineFw03)
BlineFw04<- E3_Bline_Resp[,1:3] %>% filter(Word == "w04")
Fw04 <- merge(Fw04, BlineFw04)
rm(E3_Bline_Resp, BlineFw01, BlineFw02,BlineFw03,BlineFw04)
AdaptType_Fw01 <- t.test(Fw01$`pw12_ang/pw34_fea`, Fw01$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw01 <- t_to_d(AdaptType_Fw01$statistic, AdaptType_Fw01$parameter, paired = TRUE)
AdaptType_Fw01
AdaptType_Fw01b <- t.test(Fw01$Baseline, Fw01$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Fw01b <- t_to_d(AdaptType_Fw01b$statistic, AdaptType_Fw01b$parameter, paired = TRUE)
AdaptType_Fw01b <- t.test(Fw01$Baseline, Fw01$`pw12_ang/pw34_fea`, paired = TRUE)
View(Fw01)
###now we add the Baseline information
E3_Bline_Resp <- mySummary(E3_Bline, Resp, Participant, Word, SpSex)
E3_Bline_Resp <- E3_Bline_Resp %>% filter(SpSex == "f")
E3_Bline_Resp <- E3_Bline_Resp %>% rename(Baseline = Resp)
Baseline_descriptive <- mySummary(E3_Bline_Resp, Baseline, Word)
View(E3_Bline_Resp)
#aggregate Data (in this case not really necessary)
PH1 <- E3_RespF %>% group_by(Participant, Word, AdaptType) %>% summarise(Resp = mean(Resp))
#get descriptive data
PH1_descriptive <- mySummary(PH1, Resp, Word, AdaptType)
#convert partly into wide format
PH1 <- spread(PH1, AdaptType, Resp)
###separate per speaker sex
Fw01<- PH1 %>% filter(Word == "w01")
Fw02<- PH1 %>% filter(Word == "w02")
Fw03<- PH1 %>% filter(Word == "w03")
Fw04<- PH1 %>% filter(Word == "w04")
###now we add the Baseline information
E3_Bline_Resp <- mySummary(E3_Bline, Resp, Participant, Word, SpSex)
E3_Bline_Resp <- E3_Bline_Resp %>% filter(SpSex == "f")
E3_Bline_Resp <- E3_Bline_Resp %>% rename(Baseline = Resp)
Baseline_descriptive <- mySummary(E3_Bline_Resp, Baseline, Word)
BlineFw01<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w01")
Fw01 <- merge(Fw01, BlineFw01)
BlineFw02<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w02")
Fw02 <- merge(Fw02, BlineFw02)
BlineFw03<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w03")
Fw03 <- merge(Fw03, BlineFw03)
BlineFw04<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w04")
Fw04 <- merge(Fw04, BlineFw04)
rm(E3_Bline_Resp, BlineFw01, BlineFw02,BlineFw03,BlineFw04)
AdaptType_Fw01 <- t.test(Fw01$`pw12_ang/pw34_fea`, Fw01$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw01 <- t_to_d(AdaptType_Fw01$statistic, AdaptType_Fw01$parameter, paired = TRUE)
AdaptType_Fw01
AdaptType_Fw01b <- t.test(Fw01$Baseline, Fw01$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Fw01b <- t_to_d(AdaptType_Fw01b$statistic, AdaptType_Fw01b$parameter, paired = TRUE)
AdaptType_Fw01b
AdaptType_Fw01b2 <- t.test(Fw01$Baseline, Fw01$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw01b2 <- t_to_d(AdaptType_Fw01b2$statistic, AdaptType_Fw01b2$parameter, paired = TRUE)
AdaptType_Fw01b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Fw01,d_AdaptType_Fw01,
AdaptType_Fw01b, d_AdaptType_Fw01b,
AdaptType_Fw01b2, d_AdaptType_Fw01b2,
file = "output/Exp3_Resp_post-hoc_Fw01.txt")
#keep environment tidy
rm(AdaptType_Fw01,d_AdaptType_Fw01, AdaptType_Fw01b, d_AdaptType_Fw01b, AdaptType_Fw01b2, d_AdaptType_Fw01b2)
AdaptType_Fw02 <- t.test(Fw02$`pw12_ang/pw34_fea`, Fw02$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw02 <- t_to_d(AdaptType_Fw02$statistic, AdaptType_Fw02$parameter, paired = TRUE)
AdaptType_Fw02
AdaptType_Fw02b <- t.test(Fw02$Baseline, Fw02$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Fw02b <- t_to_d(AdaptType_Fw02b$statistic, AdaptType_Fw02b$parameter, paired = TRUE)
AdaptType_Fw02b
AdaptType_Fw02b2 <- t.test(Fw02$Baseline, Fw02$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw02b2 <- t_to_d(AdaptType_Fw02b2$statistic, AdaptType_Fw02b2$parameter, paired = TRUE)
AdaptType_Fw02b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Fw02,d_AdaptType_Fw02,
AdaptType_Fw02b, d_AdaptType_Fw02b,
AdaptType_Fw02b2, d_AdaptType_Fw02b2,
file = "output/Exp3_Resp_post-hoc_Fw02.txt")
#keep environment tidy
rm(AdaptType_Fw02,d_AdaptType_Fw02, AdaptType_Fw02b, d_AdaptType_Fw02b, AdaptType_Fw02b2, d_AdaptType_Fw02b2)
AdaptType_Fw03 <- t.test(Fw03$`pw12_ang/pw34_fea`, Fw03$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw03 <- t_to_d(AdaptType_Fw03$statistic, AdaptType_Fw03$parameter, paired = TRUE)
AdaptType_Fw03
AdaptType_Fw03b <- t.test(Fw03$Baseline, Fw03$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Fw03b <- t_to_d(AdaptType_Fw03b$statistic, AdaptType_Fw03b$parameter, paired = TRUE)
AdaptType_Fw03b
AdaptType_Fw03b2 <- t.test(Fw03$Baseline, Fw03$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw03b2 <- t_to_d(AdaptType_Fw03b2$statistic, AdaptType_Fw03b2$parameter, paired = TRUE)
AdaptType_Fw03b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Fw03,d_AdaptType_Fw03,
AdaptType_Fw03b, d_AdaptType_Fw03b,
AdaptType_Fw03b2, d_AdaptType_Fw03b2,
file = "output/Exp3_Resp_post-hoc_Fw03.txt")
#keep environment tidy
rm(AdaptType_Fw03,d_AdaptType_Fw03, AdaptType_Fw03b, d_AdaptType_Fw03b, AdaptType_Fw03b2, d_AdaptType_Fw03b2)
AdaptType_Fw04 <- t.test(Fw04$`pw12_ang/pw34_fea`, Fw04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw04 <- t_to_d(AdaptType_Fw04$statistic, AdaptType_Fw04$parameter, paired = TRUE)
AdaptType_Fw04
AdaptType_Fw04b <- t.test(Fw04$Baseline, Fw04$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Fw04b <- t_to_d(AdaptType_Fw04b$statistic, AdaptType_Fw04b$parameter, paired = TRUE)
AdaptType_Fw04b
AdaptType_Fw04b2 <- t.test(Fw04$Baseline, Fw04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Fw04b2 <- t_to_d(AdaptType_Fw04b2$statistic, AdaptType_Fw04b2$parameter, paired = TRUE)
AdaptType_Fw04b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Fw04,d_AdaptType_Fw04,
AdaptType_Fw04b, d_AdaptType_Fw04b,
AdaptType_Fw04b2, d_AdaptType_Fw04b2,
file = "output/Exp3_Resp_post-hoc_Fw04.txt")
#keep environment tidy
rm(AdaptType_Fw04,d_AdaptType_Fw04, AdaptType_Fw04b, d_AdaptType_Fw04b, AdaptType_Fw04b2, d_AdaptType_Fw04b2)
E3_Resp <- mySummary(E3_Adapt, Resp, Participant, Word, AdaptType, SpSex) #does not contain Baseline
E3_RespF <- E3_Resp %>% filter(SpSex =="m")
E3_Resp <- mySummary(E3_Adapt, Resp, Participant, Word, AdaptType, SpSex) #does not contain Baseline
E3_RespM <- E3_Resp %>% filter(SpSex =="m")
a<-ezANOVA(data=E3_RespM, dv=.(Resp), wid=.(Participant), within = .(AdaptType, Word), type=3, detailed = TRUE)
b = tracedEzOut(a, print = TRUE, sph.cor = "HF", mau.p = 0.05, etasq = "partial", dfsep = ", ")
capture.output(b, file= "output/Exp3_Resp_ANOVAIIc_males.txt")
# visualize data (just to check)
ezPlot(data=E3_RespM, dv=.(Resp), wid=.(Participant), within = .(AdaptType, Word), split=Word, x=AdaptType)
#aggregate Data (in this case not really necessary)
PH1 <- E3_RespM %>% group_by(Participant, Word, AdaptType) %>% summarise(Resp = mean(Resp))
#get descriptive data
PH1_descriptive <- mySummary(PH1, Resp, Word, AdaptType)
#convert partly into wide format
PH1 <- spread(PH1, AdaptType, Resp)
###separate per speaker sex
Mw01<- PH1 %>% filter(Word == "w01")
Mw02<- PH1 %>% filter(Word == "w02")
Mw03<- PH1 %>% filter(Word == "w03")
Mw04<- PH1 %>% filter(Word == "w04")
View(Mw02)
###now we add the Baseline information
E3_Bline_Resp <- mySummary(E3_Bline, Resp, Participant, Word, SpSex)
E3_Bline_Resp <- E3_Bline_Resp %>% filter(SpSex == "m")
E3_Bline_Resp <- E3_Bline_Resp %>% rename(Baseline = Resp)
Baseline_descriptive <- mySummary(E3_Bline_Resp, Baseline, Word)
BlineMw01<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w01")
Mw01 <- merge(Mw01, BlineMw01)
BlineMw02<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w02")
Mw02 <- merge(Mw02, BlineMw02)
BlineMw03<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w03")
Mw03 <- merge(Mw03, BlineMw03)
BlineMw04<- E3_Bline_Resp[,c(1,2,4)] %>% filter(Word == "w04")
Mw04 <- merge(Mw04, BlineMw04)
rm(E3_Bline_Resp, BlineMw01, BlineMw02,BlineMw03,BlineMw04)
###now we add the Baseline information
E3_Bline_Resp <- mySummary(E3_Bline, Resp, Participant, Word, SpSex)
E3_Bline_Resp <- E3_Bline_Resp %>% filter(SpSex == "m")
E3_Bline_Resp <- E3_Bline_Resp %>% rename(Baseline = Resp)
View(E3_Bline_Resp)
AdaptType_Mw01 <- t.test(Mw01$`pw12_ang/pw34_fea`, Mw01$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw01 <- t_to_d(AdaptType_Mw01$statistic, AdaptType_Mw01$parameter, paired = TRUE)
AdaptType_Mw01
AdaptType_Mw01b <- t.test(Mw01$Baseline, Mw01$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Mw01b <- t_to_d(AdaptType_Mw01b$statistic, AdaptType_Mw01b$parameter, paired = TRUE)
AdaptType_Mw01b
AdaptType_Mw01b2 <- t.test(Mw01$Baseline, Mw01$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw01b2 <- t_to_d(AdaptType_Mw01b2$statistic, AdaptType_Mw01b2$parameter, paired = TRUE)
AdaptType_Mw01b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Mw01,d_AdaptType_Mw01,
AdaptType_Mw01b, d_AdaptType_Mw01b,
AdaptType_Mw01b2, d_AdaptType_Mw01b2,
file = "output/Exp3_Resp_post-hoc_Mw01.txt")
#keep environment tidy
rm(AdaptType_Mw01,d_AdaptType_Mw01, AdaptType_Mw01b, d_AdaptType_Mw01b, AdaptType_Mw01b2, d_AdaptType_Mw01b2)
AdaptType_Mw02 <- t.test(Mw02$`pw12_ang/pw34_fea`, Mw02$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw02 <- t_to_d(AdaptType_Mw02$statistic, AdaptType_Mw02$parameter, paired = TRUE)
AdaptType_Mw02
AdaptType_Mw02b <- t.test(Mw02$Baseline, Mw02$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Mw02b <- t_to_d(AdaptType_Mw02b$statistic, AdaptType_Mw02b$parameter, paired = TRUE)
AdaptType_Mw02b
AdaptType_Mw02b2 <- t.test(Mw02$Baseline, Mw02$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw02b2 <- t_to_d(AdaptType_Mw02b2$statistic, AdaptType_Mw02b2$parameter, paired = TRUE)
AdaptType_Mw02b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Mw02,d_AdaptType_Mw02,
AdaptType_Mw02b, d_AdaptType_Mw02b,
AdaptType_Mw02b2, d_AdaptType_Mw02b2,
file = "output/Exp3_Resp_post-hoc_Mw02.txt")
#keep environment tidy
rm(AdaptType_Mw02,d_AdaptType_Mw02, AdaptType_Mw02b, d_AdaptType_Mw02b, AdaptType_Mw02b2, d_AdaptType_Mw02b2)
AdaptType_Mw03 <- t.test(Mw03$`pw12_ang/pw34_fea`, Mw03$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw03 <- t_to_d(AdaptType_Mw03$statistic, AdaptType_Mw03$parameter, paired = TRUE)
AdaptType_Mw03
AdaptType_Mw03b <- t.test(Mw03$Baseline, Mw03$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Mw03b <- t_to_d(AdaptType_Mw03b$statistic, AdaptType_Mw03b$parameter, paired = TRUE)
AdaptType_Mw03b
AdaptType_Mw03b2 <- t.test(Mw03$Baseline, Mw03$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw03b2 <- t_to_d(AdaptType_Mw03b2$statistic, AdaptType_Mw03b2$parameter, paired = TRUE)
AdaptType_Mw03b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Mw03,d_AdaptType_Mw03,
AdaptType_Mw03b, d_AdaptType_Mw03b,
AdaptType_Mw03b2, d_AdaptType_Mw03b2,
file = "output/Exp3_Resp_post-hoc_Mw03.txt")
#keep environment tidy
rm(AdaptType_Mw03,d_AdaptType_Mw03, AdaptType_Mw03b, d_AdaptType_Mw03b, AdaptType_Mw03b2, d_AdaptType_Mw03b2)
AdaptType_Mw04 <- t.test(Mw04$`pw12_ang/pw34_fea`, Mw04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw04 <- t_to_d(AdaptType_Mw04$statistic, AdaptType_Mw04$parameter, paired = TRUE)
AdaptType_Mw04
AdaptType_Mw04b <- t.test(Mw04$Baseline, Mw04$`pw12_ang/pw34_fea`, paired = TRUE)
d_AdaptType_Mw04b <- t_to_d(AdaptType_Mw04b$statistic, AdaptType_Mw04b$parameter, paired = TRUE)
AdaptType_Mw04b
AdaptType_Mw04b2 <- t.test(Mw04$Baseline, Mw04$`pw12_fea/pw34_ang`, paired = TRUE)
d_AdaptType_Mw04b2 <- t_to_d(AdaptType_Mw04b2$statistic, AdaptType_Mw04b2$parameter, paired = TRUE)
AdaptType_Mw04b2
#save results
capture.output(as.matrix(PH1_descriptive), as.matrix(Baseline_descriptive),
AdaptType_Mw04,d_AdaptType_Mw04,
AdaptType_Mw04b, d_AdaptType_Mw04b,
AdaptType_Mw04b2, d_AdaptType_Mw04b2,
file = "output/Exp3_Resp_post-hoc_Mw04.txt")
#keep environment tidy
rm(AdaptType_Mw04,d_AdaptType_Mw04, AdaptType_Mw04b, d_AdaptType_Mw04b, AdaptType_Mw04b2, d_AdaptType_Mw04b2)
# clear directory
rm(list=ls())
#set working directory to current file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# load required packages
library("tidyverse")
library(ggsignif)
library(gridExtra) # version 2.3
library(ggpubr)    # version 0.6.0
library(cowplot)   # version 1.1.1
# load relevant functions
source("functions/mySummary.R")
load(file ="input/Exp3_without_omissions.RData")
#rename "w5" into "w4"
E3_Adapt$Word <- ifelse(E3_Adapt$Word == "w05", "w04", E3_Adapt$Word)
E3_Bline$Word <- ifelse(E3_Bline$Word == "w05", "w04", E3_Bline$Word)
#average raw data (for both Adapt and Baseline Blocks)
E3_Adapt_plot <- mySummary(E3_Adapt, Resp, Participant, tML, Word, AdaptType)
E3_Bline_plot <- mySummary(E3_Bline, Resp, Participant, tML, Word, Block)
E3_Bline_plot <- E3_Bline_plot %>% rename(AdaptType= Block)
E3_plot <- rbind(E3_Adapt_plot, E3_Bline_plot)
rm(E3_Adapt_plot, E3_Bline_plot)
E3_plot_agg<- mySummary(E3_plot, Resp, tML,  Word, AdaptType)
View(E3_plot_agg)
#[1a] Response per tML, SpID and AdaptType , females only
yTitleStr = "Proportion of angry responses"
xTitleStr = "Target Morphlevel (tML)"
facetStr =  " splitted per SpSex and AdaptType"
title = paste0("Mean ", yTitleStr, " per ", xTitleStr, facetStr)
filename = paste0("plots/01a_Resp_Exp2.png")
# New facet label names
Word.labs <- c("W01: /XXX/", "W02: /XXX/", "W03: /XXX/", "W04: /XXX/")
names(Word.labs) <- c("w01", "w02", "w03", "w04")
#Plot
p1<-(ggplot(data= E3_plot_agg, aes(x = tML, y=Resp, color = AdaptType, group=AdaptType)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(x = xTitleStr , y = yTitleStr) + #, title = title
facet_wrap(~ Word, ncol = 4, labeller = labeller(Word = Word.labs)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
scale_colour_manual(values=c("grey", "darkred", "darkgreen")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(color = "black", size = 14), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
strip.text.x = element_text(size = 14),
legend.position = "none") +
scale_y_continuous(limits=c(0,1.0), breaks = c( 0.0, 0.2, 0.4, 0.6, 0.8, 1.0)))
#abspeichern
ggsave(filename, width = 20, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#abspeichern
ggsave(filename, width = 15, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
#average raw data (for both Adapt and Baseline Blocks)
E3_Adapt_plot <- mySummary(E3_Adapt, Resp, Participant, tML, Word, AdaptType)
E3_Bline_plot <- mySummary(E3_Bline, Resp, Participant, tML, Word, Block)
E3_Bline_plot <- E3_Bline_plot %>% rename(AdaptType= Block)
E3_plot <- rbind(E3_Adapt_plot, E3_Bline_plot)
rm(E3_Adapt_plot, E3_Bline_plot)
E3_plot_agg<- mySummary(E3_plot, Resp, tML,  Word, AdaptType)
#[1a] Response per tML, SpID and AdaptType , females only
yTitleStr = "Proportion of angry responses"
xTitleStr = "Target Morphlevel (tML)"
facetStr =  " splitted per SpSex and AdaptType"
title = paste0("Mean ", yTitleStr, " per ", xTitleStr, facetStr)
filename = paste0("plots/01a_Resp_Exp2.png")
# New facet label names
Word.labs <- c("W01: /XXX/", "W02: /XXX/", "W03: /XXX/", "W04: /XXX/")
names(Word.labs) <- c("w01", "w02", "w03", "w04")
#Plot
p1<-(ggplot(data= E3_plot_agg, aes(x = tML, y=Resp, color = AdaptType, group=AdaptType)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(x = xTitleStr , y = yTitleStr) + #, title = title
facet_wrap(~ Word, ncol = 4, labeller = labeller(Word = Word.labs)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
scale_colour_manual(values=c("grey", "darkred", "darkgreen")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(color = "black", size = 14), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
strip.text.x = element_text(size = 14),
legend.position = "none") +
scale_y_continuous(limits=c(0,1.0), breaks = c( 0.0, 0.2, 0.4, 0.6, 0.8, 1.0)))
#abspeichern
ggsave(filename, width = 15, height = 4, dpi =300)
#keep environment tidy
remove(yTitleStr, xTitleStr, facetStr, title, filename)
E3_plot_agg2<- mySummary(E3_plot, Resp, Participant, Word, AdaptType)
E3_plot_agg2<- mySummary(E3_plot_agg2, Resp, Word, AdaptType)
View(E3_plot_agg2)
names(E3_plot_agg2$AdaptType)
table(E3_plot_agg2$AdaptType)
#add significance values
annotation_df <- data.frame(
Word= c("w01","w01","w01", "w02", "w02","w02", "w03", "w03","w03", "w04", "w04","w04" ),
start = c("pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline",
"pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline"),
end = c("pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang",
"pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang")),
#add significance values
annotation_df <- data.frame(
Word= c("w01","w01","w01", "w02", "w02","w02", "w03", "w03","w03", "w04", "w04","w04" ),
start = c("pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline",
"pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline"),
end = c("pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang",
"pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang"),
y = c(0.55, 0.6, 0.65, 0.55, 0.6, 0.65,
0.55, 0.6, 0.65, 0.55, 0.6, 0.65),
label = c("n.s.", "n.s.","n.s.","**","*","n.s.",
"n.s.", "n.s.","n.s.","**","*","n.s.")
)
p2<-ggplot(data= E3_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 6, vjust = -0.2, manual = TRUE) +
facet_wrap(~ Word, ncol = 4, labeller = labeller(SpID = SpID.labs)) +
scale_fill_manual(values=c("grey", "darkred", "darkgreen"),
labels=c("Baseline" = "Baseline",
"pw12_ang/pw34_fea" = "AdaptCond1: F1 ang | F2 fea",
"pw12_fea/pw34_ang" = "AdaptCond2: F1 fea | F2 ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
E3_plot_agg2<- mySummary(E3_plot, Resp, Participant, Word, AdaptType)
E3_plot_agg2<- mySummary(E3_plot_agg2, Resp, Word, AdaptType)
table(E3_plot_agg2$AdaptType)
yTitleStr = "Proportion of angry responses"
filename = paste0("plots/02_Resp_Barplot.png")
# New facet label names
Word.labs <- c("W01: /XXX/", "W02: /XXX/", "W03: /XXX/", "W04: /XXX/")
names(Word.labs) <- c("w01", "w02", "w03", "w04")
#add significance values
annotation_df <- data.frame(
Word= c("w01","w01","w01", "w02", "w02","w02", "w03", "w03","w03", "w04", "w04","w04" ),
start = c("pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline",
"pw12_ang/pw34_fea", "Baseline", "Baseline","pw12_ang/pw34_fea", "Baseline", "Baseline"),
end = c("pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang",
"pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang", "pw12_fea/pw34_ang", "pw12_ang/pw34_fea", "pw12_fea/pw34_ang"),
y = c(0.55, 0.6, 0.65, 0.55, 0.6, 0.65,
0.55, 0.6, 0.65, 0.55, 0.6, 0.65),
label = c("n.s.", "n.s.","n.s.","**","*","n.s.",
"n.s.", "n.s.","n.s.","**","*","n.s.")
)
p2<-ggplot(data= E3_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 6, vjust = -0.2, manual = TRUE) +
facet_wrap(~ Word, ncol = 4, labeller = labeller(SpID = SpID.labs)) +
scale_fill_manual(values=c("grey", "darkred", "darkgreen"),
labels=c("Baseline" = "Baseline",
"pw12_ang/pw34_fea" = "AdaptCond1: F1 ang | F2 fea",
"pw12_fea/pw34_ang" = "AdaptCond2: F1 fea | F2 ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2<-ggplot(data= E3_plot_agg2) +
geom_bar(aes(x = AdaptType, y=Resp, fill = AdaptType),stat = "identity") +
geom_errorbar(aes(x = AdaptType, ymin = (Resp-CI), ymax = (Resp+CI)), width = 0.1 ) +
labs(y = yTitleStr, fill = NULL, x = NULL) + # x = "Condition" ,
geom_signif(data = annotation_df,
aes(xmin = start, xmax = end, annotations = label, y_position = y),
textsize = 6, vjust = -0.2, manual = TRUE) +
facet_wrap(~ Word, ncol = 4, labeller = labeller(SpID = Word.labs)) +
scale_fill_manual(values=c("grey", "darkred", "darkgreen"),
labels=c("Baseline" = "Baseline",
"pw12_ang/pw34_fea" = "AdaptCond1: F1 ang | F2 fea",
"pw12_fea/pw34_ang" = "AdaptCond2: F1 fea | F2 ang")) +
coord_cartesian(ylim=c(0.2, 0.7)) +
geom_hline(yintercept = 0.5, linetype = 4) + theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x=element_blank(), # angle = 45, hjust = 1.2, vjust =  1.2
axis.text.y = element_text(color = "black", size = 14),
axis.ticks.x=element_blank(),
strip.text.x = element_text(size = 14),
legend.text = element_text(size = 14),
legend.position='bottom') +
scale_y_continuous(breaks = c(0.3, 0.4, 0.6))
p2
#abspeichern
ggsave(filename, width = 15, height = 4, dpi =300)
